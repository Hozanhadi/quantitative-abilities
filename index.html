<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ููุตุฉ ุงููุฏุฑุงุช ุงููููุฉ</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&amp;display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Tajawal', sans-serif; }
    .gradient-bg { background: linear-gradient(135deg, #1e3a5f 0%, #0d1b2a 100%); }
    .card-gradient { background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%); }
    .topic-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.15); }
    .btn-primary { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); }
    .btn-primary:hover { background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%); }
    .progress-ring { transition: stroke-dashoffset 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .animate-fade { animation: fadeIn 0.5s ease forwards; }
    .scrollbar-thin::-webkit-scrollbar { width: 6px; }
    .scrollbar-thin::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 10px; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
  </style>
  <style>
    body { box-sizing: border-box; }
  </style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-slate-50">
  <div id="app" class="h-full overflow-auto scrollbar-thin"></div>
  <script>
    // App State - using localStorage instead of SDK
    let currentUser = null;
    let isAdmin = false;
    let currentView = 'login';
    let currentTopic = null;
    let currentModel = null;
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let allRecords = [];
    let siteTitle = 'ููุตุฉ ุงููุฏุฑุงุช ุงููููุฉ';

    // Load data from localStorage
    function loadData() {
      const saved = localStorage.getItem('quizRecords');
      allRecords = saved ? JSON.parse(saved) : [];
    }

    // Save data to localStorage
    function saveData() {
      localStorage.setItem('quizRecords', JSON.stringify(allRecords));
    }

    loadData();

    // Topics Data with Guides
    const topics = [
      {
        id: 'arithmetic',
        name: 'ุงูุญุณุงุจ',
        icon: '๐ข',
        color: '#3b82f6',
        guide: `
          <h3 class="text-xl font-bold mb-4 text-blue-600">ุฏููู ูุณู ุงูุญุณุงุจ</h3>
          <div class="space-y-4 text-gray-700">
            <p><strong>ุงูุนูููุงุช ุงูุฃุณุงุณูุฉ:</strong> ุงูุฌูุนุ ุงูุทุฑุญุ ุงูุถุฑุจุ ุงููุณูุฉ</p>
            <p><strong>ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ:</strong> ููุฌุจุฉ ูุณุงูุจุฉ ูููุงุนุฏ ุงูุชุนุงูู ูุนูุง</p>
            <p><strong>ุงููุณูุฑ:</strong> ุฌูุน ูุทุฑุญ ูุถุฑุจ ููุณูุฉ ุงููุณูุฑ</p>
            <p><strong>ุงูุฃุนุฏุงุฏ ุงูุนุดุฑูุฉ:</strong> ุชุญููููุง ูุฅุฌุฑุงุก ุงูุนูููุงุช ุนูููุง</p>
            <p><strong>ุงููุณุจุฉ ุงููุฆููุฉ:</strong> ุญุณุงุจ ุงููุณุจ ูุงูุฒูุงุฏุฉ ูุงูููุตุงู</p>
            <p><strong>ูุตุงุฆุญ:</strong> ุชุฏุฑุจ ุนูู ุงูุญุณุงุจ ุงูุฐููู ุงูุณุฑูุน ูุญูุธ ุฌุฏูู ุงูุถุฑุจ</p>
          </div>
        `
      },
      {
        id: 'algebra',
        name: 'ุงูุฌุจุฑ',
        icon: '๐',
        color: '#8b5cf6',
        guide: `
          <h3 class="text-xl font-bold mb-4 text-purple-600">ุฏููู ูุณู ุงูุฌุจุฑ</h3>
          <div class="space-y-4 text-gray-700">
            <p><strong>ุงููุชุบูุฑุงุช:</strong> ุงุณุชุฎุฏุงู ุงูุฑููุฒ ููุชุนุจูุฑ ุนู ุงูุฃุนุฏุงุฏ ุงููุฌูููุฉ</p>
            <p><strong>ุงููุนุงุฏูุงุช ุงูุฎุทูุฉ:</strong> ุญู ูุนุงุฏูุงุช ูู ุงูุฏุฑุฌุฉ ุงูุฃููู</p>
            <p><strong>ุงููุนุงุฏูุงุช ุงูุชุฑุจูุนูุฉ:</strong> ุงูุชุญููู ูุงููุงููู ุงูุนุงู</p>
            <p><strong>ุงููุชุจุงููุงุช:</strong> ุญู ูุชูุซูู ุงููุชุจุงููุงุช ุนูู ุฎุท ุงูุฃุนุฏุงุฏ</p>
            <p><strong>ุงูุฏูุงู:</strong> ููู ุงูุนูุงูุฉ ุจูู ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช</p>
            <p><strong>ูุตุงุฆุญ:</strong> ุงููู ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ ุฌูุฏุงู ูุจู ุญู ุงููุณุงุฆู ุงููุนูุฏุฉ</p>
          </div>
        `
      },
      {
        id: 'geometry',
        name: 'ุงูููุฏุณุฉ',
        icon: '๐',
        color: '#10b981',
        guide: `
          <h3 class="text-xl font-bold mb-4 text-green-600">ุฏููู ูุณู ุงูููุฏุณุฉ</h3>
          <div class="space-y-4 text-gray-700">
            <p><strong>ุงูุฃุดูุงู ุงูุซูุงุฆูุฉ:</strong> ุงููุซูุซุ ุงููุฑุจุนุ ุงููุณุชุทููุ ุงูุฏุงุฆุฑุฉ</p>
            <p><strong>ุงููุญูุท ูุงููุณุงุญุฉ:</strong> ููุงููู ุญุณุงุจ ูุญูุท ููุณุงุญุฉ ุงูุฃุดูุงู</p>
            <p><strong>ุงูุฃุดูุงู ุงูุซูุงุซูุฉ:</strong> ุงูููุนุจุ ุงูุฃุณุทูุงูุฉุ ุงููุฑุฉุ ุงููุฎุฑูุท</p>
            <p><strong>ุงูุญุฌู:</strong> ููุงููู ุญุณุงุจ ุญุฌู ุงููุฌุณูุงุช</p>
            <p><strong>ุงูุฒูุงูุง:</strong> ุฃููุงุนูุง ูููุงุณุงุชูุง ูุงูุนูุงูุงุช ุจูููุง</p>
            <p><strong>ูุตุงุฆุญ:</strong> ุงุญูุธ ุงูููุงููู ุงูุฃุณุงุณูุฉ ูุงุฑุณู ุงูุฃุดูุงู ุฏุงุฆูุงู</p>
          </div>
        `
      },
      {
        id: 'statistics',
        name: 'ุงูุฅุญุตุงุก',
        icon: '๐',
        color: '#f59e0b',
        guide: `
          <h3 class="text-xl font-bold mb-4 text-amber-600">ุฏููู ูุณู ุงูุฅุญุตุงุก</h3>
          <div class="space-y-4 text-gray-700">
            <p><strong>ุงููุชูุณุท ุงูุญุณุงุจู:</strong> ูุฌููุน ุงูููู รท ุนุฏุฏูุง</p>
            <p><strong>ุงููุณูุท:</strong> ุงููููุฉ ุงููุณุทู ุจุนุฏ ุงูุชุฑุชูุจ</p>
            <p><strong>ุงููููุงู:</strong> ุงููููุฉ ุงูุฃูุซุฑ ุชูุฑุงุฑุงู</p>
            <p><strong>ุงููุฏู:</strong> ุงููุฑู ุจูู ุฃูุจุฑ ูุฃุตุบุฑ ูููุฉ</p>
            <p><strong>ุงูุงุญุชูุงูุงุช:</strong> ุญุณุงุจ ุงุญุชูุงู ูููุน ุญุฏุซ ูุนูู</p>
            <p><strong>ูุตุงุฆุญ:</strong> ุชุฏุฑุจ ุนูู ูุฑุงุกุฉ ุงูุฑุณูู ุงูุจูุงููุฉ ูุงูุฌุฏุงูู</p>
          </div>
        `
      },
      {
        id: 'comparison',
        name: 'ุงูููุงุฑูุฉ',
        icon: 'โ๏ธ',
        color: '#ef4444',
        guide: `
          <h3 class="text-xl font-bold mb-4 text-red-600">ุฏููู ูุณู ุงูููุงุฑูุฉ</h3>
          <div class="space-y-4 text-gray-700">
            <p><strong>ููุงุฑูุฉ ุงูุฃุนุฏุงุฏ:</strong> ุชุญุฏูุฏ ุงูุฃูุจุฑ ูุงูุฃุตุบุฑ ูุงููุณุงูุงุฉ</p>
            <p><strong>ููุงุฑูุฉ ุงููุณูุฑ:</strong> ุชูุญูุฏ ุงูููุงูุงุช ุฃู ุงูุชุญููู ูุนุดุฑู</p>
            <p><strong>ููุงุฑูุฉ ุงูุชุนุงุจูุฑ:</strong> ุชุจุณูุท ุซู ุงูููุงุฑูุฉ</p>
            <p><strong>ุงุณุชุฑุงุชูุฌูุงุช:</strong> ุงูุชุนููุถ ุจุฃุฑูุงู ุจุณูุทุฉ ููุชุญูู</p>
            <p><strong>ุงูุฎูุงุฑุงุช:</strong> ุฃ ุฃูุจุฑุ ุจ ุฃูุจุฑุ ูุชุณุงููุงูุ ูุง ูููู ุงูุชุญุฏูุฏ</p>
            <p><strong>ูุตุงุฆุญ:</strong> ูุง ุชุชุณุฑุน ูุงูุฑุฃ ุงูุณุคุงู ุฌูุฏุงู</p>
          </div>
        `
      },
      {
        id: 'word-problems',
        name: 'ูุณุงุฆู ููุงููุฉ',
        icon: '๐',
        color: '#06b6d4',
        guide: `
          <h3 class="text-xl font-bold mb-4 text-cyan-600">ุฏููู ูุณู ุงููุณุงุฆู ุงูููุงููุฉ</h3>
          <div class="space-y-4 text-gray-700">
            <p><strong>ุงูุฎุทูุฉ 1:</strong> ุงูุฑุฃ ุงููุณุฃูุฉ ุจุชูุนู ูุญุฏุฏ ุงููุทููุจ</p>
            <p><strong>ุงูุฎุทูุฉ 2:</strong> ุงุณุชุฎุฑุฌ ุงููุนุทูุงุช ูุงูุฃุฑูุงู ุงููููุฉ</p>
            <p><strong>ุงูุฎุทูุฉ 3:</strong> ุญุฏุฏ ุงูุนูููุฉ ุฃู ุงููุนุงุฏูุฉ ุงูููุงุณุจุฉ</p>
            <p><strong>ุงูุฎุทูุฉ 4:</strong> ุญู ูุชุญูู ูู ููุทููุฉ ุงูุฅุฌุงุจุฉ</p>
            <p><strong>ุฃููุงุน ุงููุณุงุฆู:</strong> ุงูุนูุฑุ ุงููุณุงูุฉุ ุงูุนููุ ุงูุฎูุทุงุช</p>
            <p><strong>ูุตุงุฆุญ:</strong> ุญูู ุงููุณุฃูุฉ ููุนุงุฏูุฉ ุฑูุงุถูุฉ ูุงุถุญุฉ</p>
          </div>
        `
      }
    ];

    // Generate questions for each topic
    function generateQuestions(topicId, modelNum) {
      const questions = [];
      const templates = getQuestionTemplates(topicId);
      
      for (let i = 0; i < 10; i++) {
        const template = templates[i % templates.length];
        const q = generateQuestion(template, i, modelNum);
        questions.push(q);
      }
      return questions;
    }

    function getQuestionTemplates(topicId) {
      const templates = {
        arithmetic: [
          { type: 'add', text: 'ูุง ูุงุชุฌ: {a} + {b} = ?' },
          { type: 'sub', text: 'ูุง ูุงุชุฌ: {a} - {b} = ?' },
          { type: 'mul', text: 'ูุง ูุงุชุฌ: {a} ร {b} = ?' },
          { type: 'div', text: 'ูุง ูุงุชุฌ: {a} รท {b} = ?' },
          { type: 'percent', text: 'ูุง ูููุฉ {p}% ูู {a}ุ' },
          { type: 'fraction', text: 'ูุง ูุงุชุฌ {a}/{b} + {c}/{d}ุ' },
          { type: 'order', text: 'ุฑุชุจ ูู ุงูุฃุตุบุฑ ููุฃูุจุฑ: {a}, {b}, {c}' },
          { type: 'decimal', text: 'ุญูู {a}/{b} ุฅูู ุนุฏุฏ ุนุดุฑู' },
          { type: 'ratio', text: 'ุฅุฐุง ูุงูุช ุงููุณุจุฉ {a}:{b}ุ ููุง ูููุฉ ุงูุฌุฒุก ุงูุฃูู ูู {c}ุ' },
          { type: 'mixed', text: 'ูุง ูุงุชุฌ ({a} + {b}) ร {c}ุ' }
        ],
        algebra: [
          { type: 'linear', text: 'ุญู ุงููุนุงุฏูุฉ: {a}ุณ + {b} = {c}' },
          { type: 'expr', text: 'ุจุณูุท: {a}ุณ + {b}ุณ - {c}' },
          { type: 'quad', text: 'ุญู: ุณยฒ = {a}' },
          { type: 'ineq', text: 'ุญู ุงููุชุจุงููุฉ: {a}ุณ > {b}' },
          { type: 'system', text: 'ุฅุฐุง ูุงู ุณ + ุต = {a} ู ุณ - ุต = {b}ุ ููุง ูููุฉ ุณุ' },
          { type: 'factor', text: 'ุญูู: ุณยฒ - {a}' },
          { type: 'eval', text: 'ุฅุฐุง ูุงู ุณ = {a}ุ ููุง ูููุฉ {b}ุณ + {c}ุ' },
          { type: 'func', text: 'ุฅุฐุง ูุงู ู(ุณ) = {a}ุณ + {b}ุ ููุง ูููุฉ ู({c})ุ' },
          { type: 'seq', text: 'ุฃูุฌุฏ ุงูุญุฏ ุงูุชุงูู: {a}, {b}, {c}, ...' },
          { type: 'power', text: 'ูุง ูููุฉ {a}^{b}ุ' }
        ],
        geometry: [
          { type: 'rect_area', text: 'ูุณุงุญุฉ ูุณุชุทูู ุทููู {a} ูุนุฑุถู {b}' },
          { type: 'rect_peri', text: 'ูุญูุท ูุณุชุทูู ุทููู {a} ูุนุฑุถู {b}' },
          { type: 'tri_area', text: 'ูุณุงุญุฉ ูุซูุซ ูุงุนุฏุชู {a} ูุงุฑุชูุงุนู {b}' },
          { type: 'circle_area', text: 'ูุณุงุญุฉ ุฏุงุฆุฑุฉ ูุตู ูุทุฑูุง {a} (ฯ = 3.14)' },
          { type: 'circle_circ', text: 'ูุญูุท ุฏุงุฆุฑุฉ ูุตู ูุทุฑูุง {a} (ฯ = 3.14)' },
          { type: 'cube_vol', text: 'ุญุฌู ููุนุจ ุทูู ุถูุนู {a}' },
          { type: 'box_vol', text: 'ุญุฌู ุตูุฏูู ุฃุจุนุงุฏู {a} ร {b} ร {c}' },
          { type: 'angle', text: 'ุฅุฐุง ูุงู ูุฌููุน ุฒุงููุชูู ูุชูุงููุชููุ ูุฅุญุฏุงููุง {a}ยฐุ ููุง ุงูุฃุฎุฑูุ' },
          { type: 'pyth', text: 'ูู ูุซูุซ ูุงุฆูุ ุฅุฐุง ูุงู ุงูุถูุนุงู {a} ู {b}ุ ููุง ุงููุชุฑุ' },
          { type: 'square', text: 'ูุณุงุญุฉ ูุฑุจุน ูุญูุทู {a}' }
        ],
        statistics: [
          { type: 'mean', text: 'ุงููุชูุณุท ุงูุญุณุงุจู ููุฃุนุฏุงุฏ: {a}, {b}, {c}, {d}, {e}' },
          { type: 'median', text: 'ุงููุณูุท ููุฃุนุฏุงุฏ: {a}, {b}, {c}, {d}, {e}' },
          { type: 'mode', text: 'ุงููููุงู ููุฃุนุฏุงุฏ: {a}, {b}, {a}, {c}, {a}' },
          { type: 'range', text: 'ุงููุฏู ููุฃุนุฏุงุฏ: {a}, {b}, {c}, {d}, {e}' },
          { type: 'prob', text: 'ุงุญุชูุงู ุงุฎุชูุงุฑ ูุฑุฉ ุญูุฑุงุก ูู {a} ุญูุฑุงุก ู {b} ุฒุฑูุงุก' },
          { type: 'sum', text: 'ูุฌููุน ุงูุฃุนุฏุงุฏ: {a}, {b}, {c}' },
          { type: 'count', text: 'ูู ุนุฏุฏ ุงูุฃุนุฏุงุฏ ุงูุฒูุฌูุฉ ูู 1 ุฅูู {a}ุ' },
          { type: 'avg_word', text: 'ุฅุฐุง ูุงู ูุชูุณุท {a} ุฃุนุฏุงุฏ ูู {b}ุ ููุง ูุฌููุนูุงุ' },
          { type: 'percent_stat', text: 'ูุง ูุณุจุฉ {a} ูู {b} ููุณุจุฉ ูุฆููุฉุ' },
          { type: 'data', text: 'ูู ุงุณุชุทูุงุนุ {a} ุงุฎุชุงุฑูุง ุฃ ู{b} ุงุฎุชุงุฑูุง ุจุ ูุง ุงููุฑูุ' }
        ],
        comparison: [
          { type: 'num', text: 'ูุงุฑู: {a} ู {b}' },
          { type: 'expr', text: 'ูุงุฑู: {a} + {b} ู {c} + {d}' },
          { type: 'frac', text: 'ูุงุฑู: {a}/{b} ู {c}/{d}' },
          { type: 'percent', text: 'ูุงุฑู: {a}% ูู {b} ู {c}% ูู {d}' },
          { type: 'power', text: 'ูุงุฑู: {a}ยฒ ู {b}ยฒ' },
          { type: 'root', text: 'ูุงุฑู: โ{a} ู {b}' },
          { type: 'neg', text: 'ูุงุฑู: -{a} ู -{b}' },
          { type: 'mixed', text: 'ูุงุฑู: {a} ร {b} ู {c} + {d}' },
          { type: 'abs', text: 'ูุงุฑู: |{a}| ู |{b}|' },
          { type: 'ratio', text: 'ูุงุฑู: {a}:{b} ู {c}:{d}' }
        ],
        'word-problems': [
          { type: 'age', text: 'ุนูุฑ ุฃุญูุฏ ุถุนู ุนูุฑ ุณุงูู. ุฅุฐุง ูุงู ุนูุฑ ุณุงูู {a} ุณูุฉุ ููู ุนูุฑ ุฃุญูุฏุ' },
          { type: 'money', text: 'ุงุดุชุฑู ูุชุงุจุงู ุจู{a} ุฑูุงู ูุฏูุน {b} ุฑูุงูุ ูู ุงูุจุงููุ' },
          { type: 'speed', text: 'ูุทุน ุณูุงุฑุฉ {a} ูู ูู {b} ุณุงุนุงุชุ ูุง ุณุฑุนุชูุงุ' },
          { type: 'work', text: 'ูููุฌุฒ ุนุงูู ุนููุงู ูู {a} ุฃูุงูุ ูู ููุฌุฒ ูู ููู ูุงุญุฏุ' },
          { type: 'profit', text: 'ุงุดุชุฑู ุจู{a} ูุจุงุน ุจู{b}ุ ูุง ุงูุฑุจุญุ' },
          { type: 'divide', text: 'ููุฒูุน {a} ุชูุงุญุฉ ุนูู {b} ุฃุทูุงู ุจุงูุชุณุงููุ ูู ููู ุทููุ' },
          { type: 'total', text: 'ุณุนุฑ ููู {a} ุฑูุงูุ ูู ุณุนุฑ {b} ุฃููุงูุ' },
          { type: 'diff', text: 'ุงููุฑู ุจูู ุนุฏุฏูู {a}ุ ุฃุญุฏููุง {b}ุ ูุง ุงูุขุฎุฑุ' },
          { type: 'percent_word', text: 'ุฒุงุฏ ุงูุณุนุฑ {a}% ูู {b} ุฑูุงูุ ูุง ุงูุณุนุฑ ุงูุฌุฏูุฏุ' },
          { type: 'time', text: 'ุจุฏุฃ ุงูุงุฌุชูุงุน ุงูุณุงุนุฉ {a} ูุงุณุชูุฑ {b} ุณุงุนุงุชุ ูุชู ุงูุชููุ' }
        ]
      };
      return templates[topicId] || templates.arithmetic;
    }

    function generateQuestion(template, index, modelNum) {
      const seed = modelNum * 100 + index;
      const rand = (min, max) => min + ((seed * (index + 1) * 7) % (max - min + 1));
      
      let a = rand(2, 20), b = rand(2, 15), c = rand(2, 10), d = rand(2, 8), e = rand(1, 25);
      let p = rand(10, 50);
      
      let text = template.text
        .replace('{a}', a).replace('{b}', b).replace('{c}', c)
        .replace('{d}', d).replace('{e}', e).replace('{p}', p);
      
      let answer, options;
      
      switch(template.type) {
        case 'add': answer = a + b; break;
        case 'sub': answer = a - b; break;
        case 'mul': answer = a * b; break;
        case 'div': answer = Math.round(a / b * 10) / 10; break;
        case 'percent': answer = Math.round(p * a / 100 * 10) / 10; break;
        case 'linear': answer = Math.round((c - b) / a * 10) / 10; break;
        case 'rect_area': answer = a * b; break;
        case 'rect_peri': answer = 2 * (a + b); break;
        case 'tri_area': answer = Math.round(a * b / 2 * 10) / 10; break;
        case 'circle_area': answer = Math.round(3.14 * a * a * 10) / 10; break;
        case 'cube_vol': answer = a * a * a; break;
        case 'mean': answer = Math.round((a + b + c + d + e) / 5 * 10) / 10; break;
        case 'age': answer = a * 2; break;
        case 'money': answer = b - a; break;
        case 'speed': answer = Math.round(a / b * 10) / 10; break;
        default: answer = a + b;
      }
      
      options = generateOptions(answer);
      
      return { text, options, answer: 0 };
    }

    function generateOptions(correctAnswer) {
      const options = [correctAnswer];
      const variations = [
        correctAnswer + 1, correctAnswer - 1,
        correctAnswer + 2, correctAnswer * 2,
        Math.round(correctAnswer / 2), correctAnswer + 5
      ].filter(v => v !== correctAnswer && v > 0);
      
      while (options.length < 4 && variations.length > 0) {
        const idx = Math.floor(Math.random() * variations.length);
        options.push(variations.splice(idx, 1)[0]);
      }
      
      while (options.length < 4) {
        options.push(correctAnswer + options.length);
      }
      
      return options.sort(() => Math.random() - 0.5).map(String);
    }

    // SDK Setup - Removed
    const defaultConfig = {
      site_title: 'ููุตุฉ ุงููุฏุฑุงุช ุงููููุฉ'
    };

    async function initApp() {
      render();
    }

    // Render Functions
    function render() {
      const app = document.getElementById('app');
      
      switch(currentView) {
        case 'login':
          renderLogin();
          break;
        case 'dashboard':
          renderDashboard();
          break;
        case 'topic':
          renderTopic();
          break;
        case 'guide':
          renderGuide();
          break;
        case 'quiz':
          renderQuiz();
          break;
        case 'result':
          renderResult();
          break;
        case 'admin':
          renderAdminDashboard();
          break;
      }
    }

    function renderLogin() {
      const app = document.getElementById('app');
      app.innerHTML = `
        <div class="min-h-full gradient-bg flex items-center justify-center p-4">
          <div class="w-full max-w-md">
            <div class="card-gradient rounded-3xl shadow-2xl p-8 animate-fade">
              <div class="text-center mb-8">
                <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg">
                  <span class="text-4xl">๐ฏ</span>
                </div>
                <h1 id="site-title" class="text-2xl font-bold text-gray-800">${siteTitle}</h1>
                <p class="text-gray-500 mt-2">ุณุฌูู ุฏุฎููู ููุจุฏุก</p>
              </div>
              
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุงุณู</label>
                  <input type="text" id="username" placeholder="ุฃุฏุฎู ุงุณูู" 
                    class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">ูููุฉ ุงููุฑูุฑ</label>
                  <input type="password" id="password" placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ" 
                    class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
                </div>
                
                <div id="login-error" class="hidden text-red-500 text-sm text-center bg-red-50 py-2 rounded-lg"></div>
                
                <button onclick="handleLogin()" 
                  class="w-full btn-primary text-white font-bold py-3 px-6 rounded-xl transition transform hover:scale-[1.02] active:scale-[0.98]">
                  ุชุณุฌูู ุงูุฏุฎูู
                </button>
                
                <div class="relative my-6">
                  <div class="absolute inset-0 flex items-center">
                    <div class="w-full border-t border-gray-200"></div>
                  </div>
                  <div class="relative flex justify-center text-sm">
                    <span class="px-4 bg-white text-gray-400">ุฃู</span>
                  </div>
                </div>
                
                <button onclick="showAdminLogin()" 
                  class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-xl transition">
                  ๐ ุฏุฎูู ุงููุฏูุฑ
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function handleLogin() {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const errorEl = document.getElementById('login-error');
      
      if (!username) {
        errorEl.textContent = 'ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงูุงุณู';
        errorEl.classList.remove('hidden');
        return;
      }
      
      if (password !== '2010') {
        errorEl.textContent = 'ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ';
        errorEl.classList.remove('hidden');
        return;
      }
      
      currentUser = username;
      isAdmin = false;
      currentView = 'dashboard';
      render();
    }

    function showAdminLogin() {
      const app = document.getElementById('app');
      app.innerHTML = `
        <div class="min-h-full gradient-bg flex items-center justify-center p-4">
          <div class="w-full max-w-md">
            <div class="card-gradient rounded-3xl shadow-2xl p-8 animate-fade">
              <div class="text-center mb-8">
                <div class="w-20 h-20 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg">
                  <span class="text-4xl">๐จโ๐ผ</span>
                </div>
                <h1 class="text-2xl font-bold text-gray-800">ููุญุฉ ุงููุฏูุฑ</h1>
                <p class="text-gray-500 mt-2">ุฃุฏุฎู ุจูุงูุงุช ุงููุฏูุฑ</p>
              </div>
              
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">ุงุณู ุงููุฏูุฑ</label>
                  <input type="text" id="admin-username" placeholder="ุงุณู ุงููุฏูุฑ" 
                    class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-transparent transition">
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">ูููุฉ ุงููุฑูุฑ</label>
                  <input type="password" id="admin-password" placeholder="ูููุฉ ุงููุฑูุฑ" 
                    class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-transparent transition">
                </div>
                
                <div id="admin-error" class="hidden text-red-500 text-sm text-center bg-red-50 py-2 rounded-lg"></div>
                
                <button onclick="handleAdminLogin()" 
                  class="w-full bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white font-bold py-3 px-6 rounded-xl transition transform hover:scale-[1.02]">
                  ุฏุฎูู
                </button>
                
                <button onclick="currentView='login'; render();" 
                  class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-xl transition">
                  โ ุฑุฌูุน
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function handleAdminLogin() {
      const username = document.getElementById('admin-username').value.trim();
      const password = document.getElementById('admin-password').value;
      const errorEl = document.getElementById('admin-error');
      
      if (username === 'Hozan' && password === '2010') {
        currentUser = 'Hozan';
        isAdmin = true;
        currentView = 'admin';
        render();
      } else {
        errorEl.textContent = 'ุจูุงูุงุช ุงูุฏุฎูู ุบูุฑ ุตุญูุญุฉ';
        errorEl.classList.remove('hidden');
      }
    }

    function renderDashboard() {
      const app = document.getElementById('app');
      const userRecords = allRecords.filter(r => r.student_name === currentUser);
      
      app.innerHTML = `
        <div class="min-h-full bg-slate-50">
          <!-- Header -->
          <header class="gradient-bg text-white py-6 px-4 shadow-lg">
            <div class="max-w-6xl mx-auto flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                  <span class="text-2xl">๐</span>
                </div>
                <div>
                  <h1 class="text-xl font-bold">ูุฑุญุจุงูุ ${currentUser}</h1>
                  <p class="text-blue-200 text-sm">ุงุฎุชุฑ ููุถูุนุงู ููุจุฏุก</p>
                </div>
              </div>
              <button onclick="logout()" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition">
                ุฎุฑูุฌ
              </button>
            </div>
          </header>
          
          <!-- Stats -->
          <div class="max-w-6xl mx-auto px-4 -mt-4">
            <div class="bg-white rounded-2xl shadow-lg p-6 grid grid-cols-3 gap-4">
              <div class="text-center">
                <div class="text-3xl font-bold text-blue-600">${userRecords.length}</div>
                <div class="text-gray-500 text-sm">ุงุฎุชุจุงุฑ ููุชูู</div>
              </div>
              <div class="text-center border-x border-gray-100">
                <div class="text-3xl font-bold text-green-600">${userRecords.length > 0 ? Math.round(userRecords.reduce((a, r) => a + (r.score / r.total_questions * 100), 0) / userRecords.length) : 0}%</div>
                <div class="text-gray-500 text-sm">ูุชูุณุท ุงููุชุงุฆุฌ</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-purple-600">${topics.length}</div>
                <div class="text-gray-500 text-sm">ููุถูุนุงุช ูุชุงุญุฉ</div>
              </div>
            </div>
          </div>
          
          <!-- Topics Grid -->
          <div class="max-w-6xl mx-auto px-4 py-8">
            <h2 class="text-xl font-bold text-gray-800 mb-6">๐ ุงูููุถูุนุงุช</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              ${topics.map(topic => {
                const topicRecords = userRecords.filter(r => r.topic_id === topic.id);
                const completedModels = new Set(topicRecords.map(r => r.model_number)).size;
                const progress = Math.round(completedModels / 55 * 100);
                
                return `
                  <div onclick="selectTopic('${topic.id}')" 
                    class="topic-card card-gradient rounded-2xl p-6 cursor-pointer transition-all duration-300 border border-gray-100 hover:border-gray-200">
                    <div class="flex items-start justify-between mb-4">
                      <div class="w-14 h-14 rounded-xl flex items-center justify-center text-3xl" style="background: ${topic.color}20">
                        ${topic.icon}
                      </div>
                      <div class="text-left">
                        <div class="text-2xl font-bold" style="color: ${topic.color}">${completedModels}</div>
                        <div class="text-xs text-gray-400">/ 55 ูููุฐุฌ</div>
                      </div>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">${topic.name}</h3>
                    <div class="w-full bg-gray-100 rounded-full h-2 mb-2">
                      <div class="h-2 rounded-full transition-all" style="width: ${progress}%; background: ${topic.color}"></div>
                    </div>
                    <p class="text-sm text-gray-500">${progress}% ููุชูู</p>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        </div>
      `;
    }

    function selectTopic(topicId) {
      currentTopic = topics.find(t => t.id === topicId);
      currentView = 'topic';
      render();
    }

    function renderTopic() {
      const app = document.getElementById('app');
      const userRecords = allRecords.filter(r => r.student_name === currentUser && r.topic_id === currentTopic.id);
      const completedModels = new Set(userRecords.map(r => r.model_number));
      
      app.innerHTML = `
        <div class="min-h-full bg-slate-50">
          <!-- Header -->
          <header class="gradient-bg text-white py-6 px-4">
            <div class="max-w-6xl mx-auto">
              <button onclick="currentView='dashboard'; render();" class="flex items-center gap-2 text-blue-200 hover:text-white mb-4 transition">
                <span>โ</span> ุฑุฌูุน ููุฑุฆูุณูุฉ
              </button>
              <div class="flex items-center gap-4">
                <div class="w-16 h-16 rounded-2xl flex items-center justify-center text-4xl" style="background: ${currentTopic.color}40">
                  ${currentTopic.icon}
                </div>
                <div>
                  <h1 class="text-2xl font-bold">${currentTopic.name}</h1>
                  <p class="text-blue-200">${completedModels.size} / 55 ูููุฐุฌ ููุชูู</p>
                </div>
              </div>
            </div>
          </header>
          
          <!-- Guide Button -->
          <div class="max-w-6xl mx-auto px-4 py-4">
            <button onclick="showGuide()" 
              class="w-full bg-gradient-to-r from-amber-400 to-orange-500 text-white font-bold py-4 px-6 rounded-xl shadow-lg hover:shadow-xl transition transform hover:scale-[1.01] flex items-center justify-center gap-3">
              <span class="text-2xl">๐</span>
              <span>ุนุฑุถ ุฏููู ุงููุณู ูุจู ุงูุจุฏุก</span>
            </button>
          </div>
          
          <!-- Models Grid -->
          <div class="max-w-6xl mx-auto px-4 py-4">
            <h2 class="text-lg font-bold text-gray-800 mb-4">ุงุฎุชุฑ ูููุฐุฌุงู</h2>
            <div class="grid grid-cols-5 sm:grid-cols-8 md:grid-cols-11 gap-2">
              ${Array.from({length: 55}, (_, i) => {
                const modelNum = i + 1;
                const isCompleted = completedModels.has(modelNum);
                const record = userRecords.find(r => r.model_number === modelNum);
                
                return `
                  <button onclick="startQuiz(${modelNum})" 
                    class="aspect-square rounded-xl font-bold text-sm transition-all ${
                      isCompleted 
                        ? 'bg-green-500 text-white hover:bg-green-600' 
                        : 'bg-white border-2 border-gray-200 text-gray-700 hover:border-blue-400 hover:bg-blue-50'
                    }">
                    ${modelNum}
                    ${isCompleted ? `<div class="text-[10px]">${record ? Math.round(record.score/record.total_questions*100) : 0}%</div>` : ''}
                  </button>
                `;
              }).join('')}
            </div>
          </div>
        </div>
      `;
    }

    function showGuide() {
      currentView = 'guide';
      render();
    }

    function renderGuide() {
      const app = document.getElementById('app');
      
      app.innerHTML = `
        <div class="min-h-full bg-slate-50">
          <header class="gradient-bg text-white py-6 px-4">
            <div class="max-w-4xl mx-auto">
              <button onclick="currentView='topic'; render();" class="flex items-center gap-2 text-blue-200 hover:text-white mb-4 transition">
                <span>โ</span> ุฑุฌูุน
              </button>
              <div class="flex items-center gap-4">
                <span class="text-4xl">๐</span>
                <h1 class="text-2xl font-bold">ุฏููู ${currentTopic.name}</h1>
              </div>
            </div>
          </header>
          
          <div class="max-w-4xl mx-auto px-4 py-8">
            <div class="bg-white rounded-2xl shadow-lg p-8">
              ${currentTopic.guide}
              
              <div class="mt-8 pt-6 border-t border-gray-100">
                <button onclick="currentView='topic'; render();" 
                  class="w-full btn-primary text-white font-bold py-4 px-6 rounded-xl transition">
                  ูููุช! ุงุจุฏุฃ ุงูุงุฎุชุจุงุฑุงุช โ
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function startQuiz(modelNum) {
      currentModel = modelNum;
      currentQuestionIndex = 0;
      userAnswers = [];
      currentView = 'quiz';
      render();
    }

    function renderQuiz() {
      const app = document.getElementById('app');
      const questions = generateQuestions(currentTopic.id, currentModel);
      const question = questions[currentQuestionIndex];
      const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
      
      app.innerHTML = `
        <div class="min-h-full bg-slate-50">
          <header class="bg-white shadow-sm py-4 px-4">
            <div class="max-w-4xl mx-auto">
              <div class="flex items-center justify-between mb-4">
                <button onclick="currentView='topic'; render();" class="text-gray-500 hover:text-gray-700">
                  โ ุฅููุงุก
                </button>
                <div class="text-center">
                  <div class="font-bold text-gray-800">${currentTopic.name}</div>
                  <div class="text-sm text-gray-500">ุงููููุฐุฌ ${currentModel}</div>
                </div>
                <div class="text-blue-600 font-bold">${currentQuestionIndex + 1}/${questions.length}</div>
              </div>
              <div class="w-full bg-gray-100 rounded-full h-2">
                <div class="h-2 rounded-full bg-blue-600 transition-all duration-300" style="width: ${progress}%"></div>
              </div>
            </div>
          </header>
          
          <div class="max-w-4xl mx-auto px-4 py-8">
            <div class="bg-white rounded-2xl shadow-lg p-8 animate-fade">
              <div class="text-center mb-8">
                <span class="inline-block px-4 py-2 bg-blue-50 text-blue-600 rounded-full text-sm font-medium mb-4">
                  ุงูุณุคุงู ${currentQuestionIndex + 1}
                </span>
                <h2 class="text-xl font-bold text-gray-800 leading-relaxed">${question.text}</h2>
              </div>
              
              <div class="space-y-3">
                ${question.options.map((option, idx) => `
                  <button onclick="selectAnswer(${idx})" 
                    class="w-full text-right p-4 rounded-xl border-2 border-gray-200 hover:border-blue-400 hover:bg-blue-50 transition-all flex items-center gap-4 group">
                    <span class="w-10 h-10 rounded-full bg-gray-100 group-hover:bg-blue-100 flex items-center justify-center font-bold text-gray-600 group-hover:text-blue-600">
                      ${['ุฃ', 'ุจ', 'ุฌ', 'ุฏ'][idx]}
                    </span>
                    <span class="text-gray-700 font-medium">${option}</span>
                  </button>
                `).join('')}
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function selectAnswer(answerIdx) {
      userAnswers.push(answerIdx);
      
      const questions = generateQuestions(currentTopic.id, currentModel);
      
      if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        renderQuiz();
      } else {
        finishQuiz();
      }
    }

    async function finishQuiz() {
      const questions = generateQuestions(currentTopic.id, currentModel);
      let score = 0;
      
      questions.forEach((q, idx) => {
        if (userAnswers[idx] === q.answer) score++;
      });
      
      // Check if this model was already completed
      const existingRecord = allRecords.find(r => 
        r.student_name === currentUser && 
        r.topic_id === currentTopic.id && 
        r.model_number === currentModel
      );
      
      if (existingRecord) {
        // Update existing record if score is better
        if (score > existingRecord.score) {
          existingRecord.score = score;
          existingRecord.completed_at = new Date().toISOString();
          saveData();
        }
      } else {
        // Add new record
        allRecords.push({
          type: 'quiz_result',
          student_name: currentUser,
          topic_id: currentTopic.id,
          model_number: currentModel,
          score: score,
          total_questions: questions.length,
          completed_at: new Date().toISOString()
        });
        saveData();
      }
      
      currentView = 'result';
      render();
    }

    function renderResult() {
      const app = document.getElementById('app');
      const questions = generateQuestions(currentTopic.id, currentModel);
      let score = 0;
      
      questions.forEach((q, idx) => {
        if (userAnswers[idx] === q.answer) score++;
      });
      
      const percentage = Math.round(score / questions.length * 100);
      const emoji = percentage >= 80 ? '๐' : percentage >= 60 ? '๐' : percentage >= 40 ? '๐ช' : '๐';
      const message = percentage >= 80 ? 'ููุชุงุฒ! ุฃุฏุงุก ุฑุงุฆุน' : percentage >= 60 ? 'ุฌูุฏ ุฌุฏุงู! ุงุณุชูุฑ' : percentage >= 40 ? 'ุฌูุฏ! ุชุญุชุงุฌ ูุฑุงุฌุนุฉ' : 'ุชุญุชุงุฌ ูุฒูุฏ ูู ุงูุชุฏุฑูุจ';
      
      app.innerHTML = `
        <div class="min-h-full bg-slate-50 flex items-center justify-center p-4">
          <div class="w-full max-w-md">
            <div class="bg-white rounded-3xl shadow-2xl p-8 text-center animate-fade">
              <div class="text-6xl mb-4">${emoji}</div>
              <h1 class="text-2xl font-bold text-gray-800 mb-2">${message}</h1>
              <p class="text-gray-500 mb-6">${currentTopic.name} - ุงููููุฐุฌ ${currentModel}</p>
              
              <div class="relative w-40 h-40 mx-auto mb-6">
                <svg class="transform -rotate-90" viewBox="0 0 100 100">
                  <circle cx="50" cy="50" r="45" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                  <circle cx="50" cy="50" r="45" fill="none" stroke="${percentage >= 60 ? '#22c55e' : '#f59e0b'}" 
                    stroke-width="8" stroke-linecap="round"
                    stroke-dasharray="${percentage * 2.83} 283"
                    class="progress-ring"/>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                  <div>
                    <div class="text-4xl font-bold text-gray-800">${percentage}%</div>
                    <div class="text-sm text-gray-500">${score}/${questions.length}</div>
                  </div>
                </div>
              </div>
              
              <div class="space-y-3">
                <button onclick="startQuiz(${currentModel})" 
                  class="w-full btn-primary text-white font-bold py-3 px-6 rounded-xl transition">
                  ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ
                </button>
                <button onclick="currentView='topic'; render();" 
                  class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-xl transition">
                  ุงุฎุชูุงุฑ ูููุฐุฌ ุขุฎุฑ
                </button>
                <button onclick="currentView='dashboard'; render();" 
                  class="w-full text-gray-500 hover:text-gray-700 font-medium py-2 transition">
                  ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function renderAdminDashboard() {
      const app = document.getElementById('app');
      
      // Get unique students
      const students = [...new Set(allRecords.map(r => r.student_name))];
      
      // Calculate stats per student
      const studentStats = students.map(name => {
        const records = allRecords.filter(r => r.student_name === name);
        const avgScore = records.length > 0 
          ? Math.round(records.reduce((a, r) => a + (r.score / r.total_questions * 100), 0) / records.length)
          : 0;
        return {
          name,
          totalTests: records.length,
          avgScore,
          lastActivity: records.length > 0 ? new Date(Math.max(...records.map(r => new Date(r.completed_at)))).toLocaleDateString('ar-SA') : '-'
        };
      });
      
      app.innerHTML = `
        <div class="min-h-full bg-slate-50">
          <header class="bg-gradient-to-r from-amber-500 to-orange-600 text-white py-6 px-4">
            <div class="max-w-6xl mx-auto flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                  <span class="text-2xl">๐จโ๐ผ</span>
                </div>
                <div>
                  <h1 class="text-xl font-bold">ููุญุฉ ุชุญูู ุงููุฏูุฑ</h1>
                  <p class="text-amber-100 text-sm">ูุฑุญุจุงูุ ${currentUser}</p>
                </div>
              </div>
              <button onclick="logout()" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition">
                ุฎุฑูุฌ
              </button>
            </div>
          </header>
          
          <!-- Overview Stats -->
          <div class="max-w-6xl mx-auto px-4 -mt-4">
            <div class="bg-white rounded-2xl shadow-lg p-6 grid grid-cols-4 gap-4">
              <div class="text-center">
                <div class="text-3xl font-bold text-blue-600">${students.length}</div>
                <div class="text-gray-500 text-sm">ุนุฏุฏ ุงูุทูุงุจ</div>
              </div>
              <div class="text-center border-x border-gray-100">
                <div class="text-3xl font-bold text-green-600">${allRecords.length}</div>
                <div class="text-gray-500 text-sm">ุฅุฌูุงูู ุงูุงุฎุชุจุงุฑุงุช</div>
              </div>
              <div class="text-center border-l border-gray-100">
                <div class="text-3xl font-bold text-purple-600">${allRecords.length > 0 ? Math.round(allRecords.reduce((a, r) => a + (r.score / r.total_questions * 100), 0) / allRecords.length) : 0}%</div>
                <div class="text-gray-500 text-sm">ูุชูุณุท ุงููุชุงุฆุฌ</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-amber-600">${topics.length * 55}</div>
                <div class="text-gray-500 text-sm">ุฅุฌูุงูู ุงูููุงุฐุฌ</div>
              </div>
            </div>
          </div>
          
          <!-- Students Table -->
          <div class="max-w-6xl mx-auto px-4 py-8">
            <h2 class="text-xl font-bold text-gray-800 mb-6">๐ ูุงุฆูุฉ ุงูุทูุงุจ</h2>
            
            ${students.length === 0 ? `
              <div class="bg-white rounded-2xl shadow-lg p-12 text-center">
                <div class="text-6xl mb-4">๐ญ</div>
                <h3 class="text-xl font-bold text-gray-700 mb-2">ูุง ููุฌุฏ ุทูุงุจ ุจุนุฏ</h3>
                <p class="text-gray-500">ุณูุธูุฑ ุงูุทูุงุจ ููุง ุจุนุฏ ุชุณุฌูู ุฏุฎูููู ูุฅููุงู ุงูุงุฎุชุจุงุฑุงุช</p>
              </div>
            ` : `
              <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                <table class="w-full">
                  <thead class="bg-gray-50">
                    <tr>
                      <th class="text-right py-4 px-6 font-bold text-gray-700">ุงูุทุงูุจ</th>
                      <th class="text-center py-4 px-6 font-bold text-gray-700">ุงูุงุฎุชุจุงุฑุงุช ุงูููุชููุฉ</th>
                      <th class="text-center py-4 px-6 font-bold text-gray-700">ูุชูุณุท ุงููุชุงุฆุฌ</th>
                      <th class="text-center py-4 px-6 font-bold text-gray-700">ุขุฎุฑ ูุดุงุท</th>
                      <th class="text-center py-4 px-6 font-bold text-gray-700">ุงูุชูุงุตูู</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-100">
                    ${studentStats.map(student => `
                      <tr class="hover:bg-gray-50 transition">
                        <td class="py-4 px-6">
                          <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold">
                              ${student.name.charAt(0)}
                            </div>
                            <span class="font-medium text-gray-800">${student.name}</span>
                          </div>
                        </td>
                        <td class="py-4 px-6 text-center">
                          <span class="px-3 py-1 bg-blue-50 text-blue-600 rounded-full font-medium">${student.totalTests}</span>
                        </td>
                        <td class="py-4 px-6 text-center">
                          <span class="px-3 py-1 ${student.avgScore >= 60 ? 'bg-green-50 text-green-600' : 'bg-amber-50 text-amber-600'} rounded-full font-medium">
                            ${student.avgScore}%
                          </span>
                        </td>
                        <td class="py-4 px-6 text-center text-gray-500">${student.lastActivity}</td>
                        <td class="py-4 px-6 text-center">
                          <button onclick="showStudentDetails('${student.name}')" 
                            class="text-blue-600 hover:text-blue-800 font-medium">
                            ุนุฑุถ ุงูุชูุงุตูู
                          </button>
                        </td>
                      </tr>
                    `).join('')}
                  </tbody>
                </table>
              </div>
            `}
          </div>
          
          <!-- Topics Progress -->
          <div class="max-w-6xl mx-auto px-4 pb-8">
            <h2 class="text-xl font-bold text-gray-800 mb-6">๐ ุฅุญุตุงุฆูุงุช ุงูููุถูุนุงุช</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              ${topics.map(topic => {
                const topicRecords = allRecords.filter(r => r.topic_id === topic.id);
                const avgScore = topicRecords.length > 0 
                  ? Math.round(topicRecords.reduce((a, r) => a + (r.score / r.total_questions * 100), 0) / topicRecords.length)
                  : 0;
                
                return `
                  <div class="bg-white rounded-xl p-6 shadow-lg">
                    <div class="flex items-center gap-3 mb-4">
                      <span class="text-3xl">${topic.icon}</span>
                      <h3 class="font-bold text-gray-800">${topic.name}</h3>
                    </div>
                    <div class="grid grid-cols-2 gap-4 text-center">
                      <div>
                        <div class="text-2xl font-bold" style="color: ${topic.color}">${topicRecords.length}</div>
                        <div class="text-xs text-gray-500">ุงุฎุชุจุงุฑ ููุชูู</div>
                      </div>
                      <div>
                        <div class="text-2xl font-bold text-gray-700">${avgScore}%</div>
                        <div class="text-xs text-gray-500">ูุชูุณุท ุงููุชุงุฆุฌ</div>
                      </div>
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        </div>
      `;
    }

    function showStudentDetails(studentName) {
      const studentRecords = allRecords.filter(r => r.student_name === studentName);
      
      const modal = document.createElement('div');
      modal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50';
      modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
      
      modal.innerHTML = `
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[80%] overflow-hidden">
          <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6">
            <div class="flex items-center justify-between">
              <h2 class="text-xl font-bold">ุชูุงุตูู ุงูุทุงูุจ: ${studentName}</h2>
              <button onclick="this.closest('.fixed').remove()" class="text-white/80 hover:text-white text-2xl">ร</button>
            </div>
          </div>
          <div class="p-6 overflow-auto max-h-96">
            ${studentRecords.length === 0 ? `
              <p class="text-center text-gray-500 py-8">ูุง ุชูุฌุฏ ูุชุงุฆุฌ ุจุนุฏ</p>
            ` : `
              <table class="w-full">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="text-right py-3 px-4 text-sm font-bold text-gray-600">ุงูููุถูุน</th>
                    <th class="text-center py-3 px-4 text-sm font-bold text-gray-600">ุงููููุฐุฌ</th>
                    <th class="text-center py-3 px-4 text-sm font-bold text-gray-600">ุงููุชูุฌุฉ</th>
                    <th class="text-center py-3 px-4 text-sm font-bold text-gray-600">ุงูุชุงุฑูุฎ</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-100">
                  ${studentRecords.map(record => {
                    const topic = topics.find(t => t.id === record.topic_id);
                    const percentage = Math.round(record.score / record.total_questions * 100);
                    return `
                      <tr>
                        <td class="py-3 px-4">
                          <span class="flex items-center gap-2">
                            <span>${topic?.icon || '๐'}</span>
                            <span>${topic?.name || record.topic_id}</span>
                          </span>
                        </td>
                        <td class="py-3 px-4 text-center">${record.model_number}</td>
                        <td class="py-3 px-4 text-center">
                          <span class="px-2 py-1 rounded-full text-sm ${percentage >= 60 ? 'bg-green-100 text-green-700' : 'bg-amber-100 text-amber-700'}">
                            ${record.score}/${record.total_questions} (${percentage}%)
                          </span>
                        </td>
                        <td class="py-3 px-4 text-center text-gray-500 text-sm">
                          ${new Date(record.completed_at).toLocaleDateString('ar-SA')}
                        </td>
                      </tr>
                    `;
                  }).join('')}
                </tbody>
              </table>
            `}
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }

    function logout() {
      currentUser = null;
      isAdmin = false;
      currentView = 'login';
      currentTopic = null;
      currentModel = null;
      render();
    }

    // Initialize
    initApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d269cf213b674d8',t:'MTc3MTg0ODU1My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>